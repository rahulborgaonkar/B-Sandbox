<!-- codaamendcreditnoteheader.page -->
<apex:page standardController="c2g__codaCreditNote__c" extensions="c2g.CODAAmendCreditNoteController">
	<script src="{!URLFOR($Resource.coda2go,'coda2go/web/script/lib.js')}" type="text/javascript"></script>	
	<apex:stylesheet value="{!URLFOR($Resource.c2g__coda2go,'coda2go/web/css/style.css')}"/>
	<script>
		var CODA2GoButtons = new CODA2GoPage();
		var CODA2GoBtnSaveValue = "{!$Label.codaPageCreditNoteViewProcessing}";
	</script>
	<apex:form onsubmit="if(CODA2GoButtons.disableSaveButtons){ return CODA2GoButtons.disableSaveButtons(); }">
		
		<!-- Header -->
		<apex:sectionHeader title="{!$Label.codaPageCreditNoteAmendDocument}" subtitle="{!viewState.dto.Name}" help="{!URLFOR('/apex/c2g__codahelploader?topicid=1021')}"/>		
		
		<!-- CreditNote Detail -->
		<apex:pageBlock title="{!$Label.codaPageCreditNoteViewCreditNoteDetail2}">			
			<apex:pageBlockButtons >				
				<apex:commandButton value="{!$Label.codaPageCreditNoteAmendSave}" action="{!amend}" id="amend_h" styleclass="hiddensubmit"/>
				<apex:commandButton value="{!$Label.codaPageCreditNoteAmendCancel}" action="{!cancel}" id="cancel_h" styleclass="hiddensubmit" immediate="true" reRender=""/>
				<apex:commandButton value="{!$Label.codaPageCreditNoteAmendSave}" id="amend" 
					onclick="document.getElementById('{!$Component.amend_h}').click();return false;" rerender="" rendered="{!!viewState.HasErrors}"/>				
				<apex:commandButton value="{!$Label.codaPageCreditNoteAmendCancel}" id="cancel" rerender="" 
					onclick="if(!CODA.queing()){document.getElementById('{!$Component.cancel_h}').click()};return false;"/>
				<script>
	                if (document.getElementById("{!$Component.amend}"))
	                	CODA2GoButtons.initButtons(["{!$Component.amend}","{!$Component.cancel}"]);
	                else
	                	CODA2GoButtons.initButtons(["{!$Component.cancel}"]);
				</script>
			</apex:pageBlockButtons>
			
			<!-- Messages -->
			<apex:PageMessages />

			<apex:pageBlockSection title="{!$Label.codaPageCreditNoteViewAccountDetail}" rendered="{!!viewstate.HasErrors}">								
				<!-- Account Detail -->																
				<apex:outputField value="{!viewState.dto.c2g__Account__c}"/>																	
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$Label.codaPageOpportunityConvertOpportunity}"/>
					<apex:outputField value="{!viewState.dto.c2g__Opportunity__c}"/>
				</apex:pageBlockSectionItem>  						
				<apex:pageBlockSectionItem rendered="{!viewstate.isSalesAndUse}">
					<apex:outputLabel value="{!$Label.codaPageCreditNoteViewTaxCodes}"/>										
					<apex:outputText value="{!viewstate.taxCodesAsString}"/>
				</apex:pageBlockSectionItem> 
				<apex:pageBlockSectionItem rendered="{!viewstate.isSalesAndUse}">&nbsp;</apex:pageBlockSectionItem>				 							
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$Label.codaPageCreditNoteViewInvoiceNumber}"/>
					<apex:outputField value="{!viewState.dto.c2g__Invoice__c}"/>
				</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$Label.codaPageCreditNoteViewBillingAddress}"/>
					<apex:outputPanel >
						<apex:outputText value="{!viewstate.billingAddress.fullAddress}"/>&nbsp;
					</apex:outputPanel>
				</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$Label.codaPageCreditNoteViewShippingAddress}"/>
					<apex:outputPanel >
						<apex:outputText value="{!viewstate.shippingAddress.fullAddress}"/>&nbsp;
					</apex:outputPanel>
				</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$Label.codaPageCreditNoteViewInvoiceEmail}"/>
					<apex:outputText value="{!viewstate.account.Dto.c2g__CODAInvoiceEmail__c}"/> 					
				</apex:pageBlockSectionItem>
			</apex:pageBlockSection>		
			
			<!-- CreditNote Detail -->
			<apex:pageBlockSection title="{!$Label.codaPageCreditNoteViewCreditNoteDetail3}" rendered="{!!viewstate.HasErrors}">	
				<apex:outputField value="{!viewState.dto.Name}"/>
				<apex:outputField value="{!viewState.dto.c2g__Transaction__c}"/>
				<apex:outputField value="{!viewState.dto.c2g__CreditNoteDate__c}"/>								
				<apex:outputField value="{!viewState.dto.c2g__Period__c}"/>															
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$Label.codaPageCreditNoteViewCustomerReferenc}"/>
					<apex:outputPanel >
						<apex:inputField id="customerReference" value="{!viewState.dto.c2g__CustomerReference__c}"/>&nbsp;
					</apex:outputPanel>
				</apex:pageBlockSectionItem>				
				<apex:inputField value="{!viewState.dto.c2g__DueDate__c}"/>
				<apex:inputField value="{!viewState.dto.c2g__CreditNoteReason__c}"/>	
				<apex:pageBlockSectionItem id="currencyblock">
					<apex:outputLabel value="{!$Label.codaPageInvoiceAmendInvoiceCurrency}"/>
					<apex:outputText value="{!viewState.creditNoteCurrency.Name}"/>
				</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem rendered="{!viewstate.isConvertedFromInvoice}">
					<apex:outputLabel value="{!$Label.codaPageCreditNoteViewInvoiceDate}"/>
					<apex:outputField value="{!viewState.dto.c2g__InvoiceDate__c}"/>
				</apex:pageBlockSectionItem>															
			</apex:pageBlockSection>
			
			<!-- Notes and Analysis -->		
			<c:SubAnalysis record="{!viewState.dto}" title="{!$Label.codaNotesAndAnalysis}" id="headerDimensionBlock" readOnly="false" amend="true" override-desc="CreditNoteDescription__c" rendered="{!!viewstate.hasErrors}"/>				
		</apex:pageBlock>
	</apex:form>
</apex:page>